<div class="content">
  <div class="top">
    <h2>Dashboard</h2>

    <div *ngIf="totals.total< 5" class="actions">
      <app-button routerLink="/vmCreate"> + Adicionar VM </app-button>
    </div>

    <small class="warn" *ngIf="totals.total >= 5">
      Limite máximo de 5 VMs atingido.
    </small>
  </div>

  <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>

  <div class="cards">
    <div class="card">
      <div class="label">Total de VMs</div>
      <div class="value">{{ totals.total }}</div>
    </div>

    <div class="card">
      <div class="label">Running</div>
      <div class="value">{{ totals.START }}</div>
      <div class="hint">START</div>
    </div>

    <div class="card">
      <div class="label">Stopped</div>
      <div class="value">{{ totals.STOP }}</div>
      <div class="hint">STOP</div>
    </div>

    <div class="card">
      <div class="label">Suspended</div>
      <div class="value">{{ totals.SUSPEND }}</div>
      <div class="hint">SUSPEND</div>
    </div>
  </div>

  <div class="charts">
    <div class="panel">
      <h3>Status das VMs</h3>
      <canvas #statusBarCanvas></canvas>
    </div>

    <div class="panel">
      <h3>Limite de Capacidade (máx 5)</h3>
      <canvas #capacityPieCanvas></canvas>
    </div>
  </div>

  <div class="panel">
    <h3>VMs</h3>

    <div class="empty" *ngIf="!loading && latestVms.length === 0">
      Nenhuma VM cadastrada ainda.
    </div>

    <table *ngIf="latestVms.length > 0">
      <thead>
        <tr>
          <th>Nome</th>
          <th>CPU</th>
          <th>Memória</th>
          <th>Disco</th>
          <th>Status</th>
          <th>Criada em</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let vm of latestVms">
          <td>
            <a class="link" [routerLink]="['/vm', vm.id, 'view']">
              {{ vm.nome }}
            </a>
          </td>

          <td>{{ vm.cpu }}</td>
          <td>{{ vm.memoria }}</td>
          <td>{{ vm.disco }}</td>

          <td>
            <span
              class="badge"
              [class.start]="vm.status === 'START'"
              [class.stop]="vm.status === 'STOP'"
              [class.susp]="vm.status === 'SUSPEND'"
            >
              {{ vm.status }}
            </span>
          </td>

          <td>{{ vm.dataCriacao | date: "dd/MM/yyyy HH:mm" }}</td>

          <td class="actions-col">
            <app-button [routerLink]="['/vm', vm.id, 'edit']">Editar</app-button>
            <app-button (click)="deleteVm(vm.id)">Deletar</app-button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
